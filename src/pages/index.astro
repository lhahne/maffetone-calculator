---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Maffetone 180 Formula Calculator">
  <main class="mx-auto flex min-h-screen max-w-5xl flex-col gap-10 px-6 pb-14 pt-24">
    <header class="space-y-4">
      <p class="text-sm font-semibold uppercase tracking-[0.3em] text-sky-300">
        Maffetone 180 Formula
      </p>
      <h1 class="text-4xl font-semibold leading-tight text-white md:text-5xl">
        Find your aerobic heart-rate training zone in seconds.
      </h1>
      <p class="max-w-2xl text-lg text-slate-300">
        The 180 formula helps you build endurance by keeping your training within
        a personalized aerobic range. Answer the questions below to calculate
        your target heart-rate zone.
      </p>
    </header>

    <section class="grid gap-10 lg:grid-cols-[1.1fr_0.9fr]">
      <form
        id="calculator-form"
        class="space-y-8 rounded-3xl border border-white/10 bg-white/5 p-8 shadow-glow backdrop-blur"
      >
        <div class="space-y-3">
          <label for="age" class="text-lg font-semibold text-white">
            What is your current age?
          </label>
          <div class="flex flex-col gap-3 sm:flex-row sm:items-center">
            <input
              id="age"
              name="age"
              type="number"
              inputmode="numeric"
              min="1"
              max="120"
              placeholder="e.g. 34"
              value="39"
              class="w-full rounded-2xl border border-white/10 bg-slate-900/60 px-4 py-3 text-lg text-white shadow-inner outline-none transition focus:border-sky-400 focus:ring-2 focus:ring-sky-400/50"
              required
            />
            <span class="rounded-2xl border border-white/10 bg-slate-900/60 px-4 py-3 text-sm uppercase tracking-[0.2em] text-slate-400">
              years
            </span>
          </div>
        </div>

        <fieldset class="space-y-4">
          <legend class="text-lg font-semibold text-white">
            Which statement best describes your training status?
          </legend>
          <div class="grid gap-4">
            <label
              class="flex cursor-pointer items-start gap-4 rounded-2xl border border-white/10 bg-slate-900/50 p-4 transition hover:border-sky-400/70"
            >
              <input
                type="radio"
                name="adjustment"
                value="-10"
                class="mt-1 h-5 w-5 accent-sky-400"
              />
              <span class="text-sm text-slate-200">
                Recovering from a major illness, injury, or on medication.
              </span>
            </label>
            <label
              class="flex cursor-pointer items-start gap-4 rounded-2xl border border-white/10 bg-slate-900/50 p-4 transition hover:border-sky-400/70"
            >
              <input
                type="radio"
                name="adjustment"
                value="-5"
                class="mt-1 h-5 w-5 accent-sky-400"
              />
              <span class="text-sm text-slate-200">
                Recently injured, inconsistent training, or not improving.
              </span>
            </label>
            <label
              class="flex cursor-pointer items-start gap-4 rounded-2xl border border-white/10 bg-slate-900/50 p-4 transition hover:border-sky-400/70"
            >
              <input
                type="radio"
                name="adjustment"
                value="0"
                class="mt-1 h-5 w-5 accent-sky-400"
                checked
              />
              <span class="text-sm text-slate-200">
                Healthy, training consistently, and making steady progress.
              </span>
            </label>
            <label
              class="flex cursor-pointer items-start gap-4 rounded-2xl border border-white/10 bg-slate-900/50 p-4 transition hover:border-sky-400/70"
            >
              <input
                type="radio"
                name="adjustment"
                value="5"
                class="mt-1 h-5 w-5 accent-sky-400"
              />
              <span class="text-sm text-slate-200">
                Training for 2+ years without injury and improving.
              </span>
            </label>
          </div>
        </fieldset>
      </form>

      <aside class="space-y-6">
        <div
          class="rounded-3xl border border-white/10 bg-white/5 p-8 shadow-xl backdrop-blur"
        >
          <p class="text-sm uppercase tracking-[0.3em] text-sky-300">
            Your target range
          </p>
          <div id="result" class="mt-6 space-y-3">
            <div class="text-4xl font-semibold text-white" id="result-range">
              --
            </div>
            <div class="text-sm text-slate-300">
              Maximum aerobic heart rate: <span id="result-base">--</span>
            </div>
          </div>
          <p id="result-note" class="mt-4 text-sm text-slate-400">
            Enter a valid age to see your range.
          </p>
        </div>
        <div class="rounded-3xl border border-white/10 bg-slate-900/60 p-6">
          <h2 class="text-lg font-semibold text-white">How to use it</h2>
          <ul class="mt-4 list-disc space-y-2 pl-5 text-sm text-slate-300">
            <li>
              Warm up and keep your heart rate between the low and high numbers.
            </li>
            <li>
              Stay at or below the maximum value for most aerobic workouts.
            </li>
            <li>
              Reassess every few months as fitness and health improve.
            </li>
          </ul>
        </div>
        <div class="rounded-3xl border border-white/10 bg-slate-900/60 p-6">
          <h2 class="text-lg font-semibold text-white">References</h2>
          <ul class="mt-4 space-y-2 text-sm text-slate-300">
            <li>
              <a
                class="text-sky-300 underline-offset-4 transition hover:text-sky-200 hover:underline"
                href="https://philmaffetone.com/180-formula/"
                rel="noreferrer"
                target="_blank"
              >
                Dr. Phil Maffetone: The 180 Formula
              </a>
            </li>
            <li>
              <a
                class="text-sky-300 underline-offset-4 transition hover:text-sky-200 hover:underline"
                href="https://philmaffetone.com/faq/"
                rel="noreferrer"
                target="_blank"
              >
                Maffetone Method FAQs
              </a>
            </li>
            <li>
              <a
                class="text-sky-300 underline-offset-4 transition hover:text-sky-200 hover:underline"
                href="https://philmaffetone.com/the-maffetone-method/"
                rel="noreferrer"
                target="_blank"
              >
                Overview of the Maffetone Method
              </a>
            </li>
          </ul>
        </div>
      </aside>
    </section>
  </main>

  <script>
    import { setupMaffetoneCalculator } from "../scripts/maffetone-ui.js";

    // Run on first load
    setupMaffetoneCalculator();

    // Run on view transitions
    document.addEventListener('astro:after-swap', () => setupMaffetoneCalculator());
  </script>
</Layout>
